close all
clearvars

fign = 'figs/loading8.eps';
set(figure(1), 'Position', [1         216        1434         589])
ei=1;
while ei<=8
    %ei=4;
    if ei==1
        exp = 'M8_1'
        eps = [-2.03001881111954e-05,0,0.000522781452387529,0.00121819662381035,0.00184024683277813,0.00274469312056976,0.00338150434922441,0.00372527028523123,0.00414863292882123,0.00448316871249483,0.00479096571779965,0.00541261888002258,0.00596955636257867,0.00615661821273273,0.00649584449014988,0.00673459560162674,0.00677215218466745,0.00689671064434973,0.00720958046909186,0.00734564705569228,0.00749905768560120,0.00771101038429390,0.00773994919727317,0.00786840057450125,0.00801826785258180,0.00808462234107400,0.00810475060338903,0.00850984556992145,0.00871044801277785,0.00875294919698012,0.00913995098706024,0.00928625548516656,0.00960890621069436,0.00986049973259671,0.0111786022419718,0.0120306436927137,0.0126886264375026,0.0143541131909747,0.0179358159993003];
        axial_stress= [26:4:78 80:2:118 122:2:130];
        Pc  = 20;
        Poring  = 10;
        diff_stress = axial_stress - Pc - Poring;
        fail_stress = 130.7 - 20 - Poring;
    elseif ei==2
        exp          = 'M8_2'   %FOR THIS SAMPLE, AXIAL STRESS, STRAIN, ETC WERE WRONG
        eps          = [0.0000 0.0022 0.0040 0.0050 0.0058 0.0064 0.0071 0.0078 0.0085 0.0088 0.0091 0.0092 0.0095 0.0097 0.0099 0.0101 0.0103 0.0104 0.0106 0.0107 0.0109 0.0109 0.0110 0.0111 0.0112 0.0113 0.0114 0.0116 0.0117 0.0118 0.0119 0.0120 0.0121 0.0122 0.0124 0.0125 0.0125 0.0126 0.0127 0.0128 0.0129 0.0130 0.0130 0.0131 0.0132 0.0133 0.0133 0.0134 0.0135 0.0136 0.0137 0.0138 0.0140 0.0141 0.0142 0.0143 0.0144 0.0145 0.0146 0.0147 0.0148 0.0150 0.0152 0.0153 0.0156 0.0164 0.0165 0.0166 0.0166 0.0168 0.0169 0.0172 0.0173 0.0176 0.0179 0.0183 0.0187 0.0191 0.0197 0.0203 0.0211 0.0221 0.0235 0.0249 0.0276 0.0303 0.0342 0.041];
        scans        = 6:1:93;
        axial_stress = [40 45 50 55 60 65 70 75 80 85 90 95 100 102 104 106 108 110 112 114 116 118 120 122 124 126 128 130 132 134 136 138 140 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196];
        Pc           = 25;
        Pp           = 0;
        Poring       = 15;
        diff_stress  = axial_stress - (Pc - Pp) - Poring;
        fail_stress  = 196.82 - 25 - Poring;
        yield_num    = 63;
        fail_num     = 93;
    elseif ei==5
        exp = 'MONZ5'
        eps = [0,0.000520896396643582,0.000565057308179304,0.000565057308179304,0.00144285771037294,0.00179044891184473,0.00202193960893290,0.00234247168774349,0.00262535710923129,0.00280385219940827,0.00308025352588809,0.00336282532037290,0.00353827499693181,0.00380550892890306,0.00371397859475841,0.00383780985510562,0.00398948133713483,0.00412227855752683,0.00412577243105825,0.00424876882778459,0.00440830175525779,0.00438715597224558,0.00450737311718093,0.00460775029723442,0.00472436423356356,0.00478337509383657,0.00483230638957589,0.00488798216196906,0.00500284851785297,0.00509451738991510,0.00523720726712148,0.00524427308726574,0.00533698489502356,0.00540777283478546,0.00552035227071249,0.00558901543026481,0.00563629603091059,0.00564893316838202,0.00566116762560211,0.00571170869790156,0.00580270865246343,0.00584696162946262,0.00591049338038226,0.00594146873966601,0.00598973107962186,0.00604238732261273,0.00610790701010003,0.00618521365695499,0.00642618462062374,0.00682345276657119,0.00731838216744572,0.00771510220302517,0.00800141540237591,0.00859970283308320,0.00878111859782862,0.00898452241936136,0.00903862264524355,0.00921404257037458,0.00937598348103528,0.00957737791605581,0.00974502374727031,0.00988982760426477,0.0100887883610244,0.0101991538004493,0.0104194286962181,0.0105057145158721,0.0107993153659067,0.0112096558131711,0.0114507111738095,0.0116077981420347,0.0118999909838763,0.0122895692930860,0.0125751884795786,0.0130550674940823,0.0139732422411783,0.0166154756551105];
        axial_stress = [30:5:40 40:5:85 90:2:128 130:1:149 150.5:0.5:161.5];
        Pc = 25;
        Poring = 21.875-0.2344;
        diff_stress = axial_stress*(25/16) - Pc - Poring;
        fail_stress = (161.36*25/16) - 25 - Poring;
    elseif ei==8
        exp = 'WG04'
        eps = [-3.24725111296403e-05,-3.24725111296403e-05,3.96592145395152e-05,0.000478154160370096,0.00142566248401972,0.00219352628996349,0.00263942385778768,0.00329705401634171,0.00382386437083564,0.00435810900561488,0.00478941196467704,0.00519583321321703,0.00569506454958507,0.00585577502878968,0.00647453044702143,0.00675086476123988,0.00729654638328506,0.00754953849306628,0.00754953849306628,0.00783967750887002,0.00781976036702274,0.00794289762295500,0.00822298339370463,0.00845597461761270,0.00834949589225297,0.00895178007349243,0.00910823886204997,0.00873924637661112,0.00935130679537131,0.00956910623375778,0.00951794665792251,0.00971629507883564,0.0100219109505851,0.0102354281952052,0.0102713486245753,0.0105133548253098,0.0103638313530440,0.0105426430232638,0.0106777409254468,0.0108871913378889,0.0108376700885409,0.0109895351745709,0.0110794550880407,0.0110755037847175,0.0113199639622193,0.0114993674425962,0.0114993674425962,0.0119108372596804,0.0120434032821980,0.0121833324322012,0.0122530179407622,0.0123824551981868,0.0127886318273331];
        % removed scans 46, 47, stresses = 142, 143
        scans = [1 2 4:10 12:22 25:36 39:44 48:55 59 60 60 60:63];
        axial_stress = [15 15:5:95 95:5:110 112:2:140 141 144:1:148 148.5 149 149.5 149.5 150 150.5 151 151.5 152 152.5];
        Pc = 10;
        Poring = 13.43;
        diff_stress = axial_stress.*(25/16) - Pc - Poring;           % Differential stress of all the volumes \sigma
        fail_stress = 152.544*25/16 - 10 - Poring;   % Differential stress at failure \sigma_c
    elseif ei==3
        % MONZ3
        exp           = 'MONZ3'
        eps           =[0 0.0004 0.0011 0.0015 0.0017 0.0020 0.0025 0.0032 0.0034 0.0037 0.0041 0.0044 0.0045 0.0049 0.0051 0.0055 0.0056 0.0058 0.0060 0.0060 0.0062 0.0063 0.0064 0.0063 0.0065 0.0066 0.0068 0.0067 0.0069 0.0069 0.0070 0.0071 0.0073 0.0072 0.0073 0.0074 0.0075 0.0075 0.0075 0.0077 0.0076 0.0078 0.0078 0.0079 0.0080 0.0082 0.0082 0.0083 0.0084 0.0085 0.0087 0.0087 0.0088 0.0088 0.0090 0.0092 0.0096 0.0096 0.0098 0.0099 0.0105];
        scans         = [2:1:8 11:1:58 60:1:65];
        axial_stress  = ([29 35:5:65 70:5:115 120:2:140 142:1:156 158:1:168 170:1:175]+0.15)*25/16;
        Pc            = 20;
        Poring        = 25.54;
        diff_stress   = axial_stress - Pc - Poring;
        fail_stress   = 175.204*25/16 - 20 - Poring;
        yield_scan    = 41;
        fail_scan     = 65;
    elseif ei==4
        % MONZ4
        exp          = 'MONZ4'
        eps          = [0 0.0004 0.0012 0.0016 0.0024 0.0028 0.0031 0.0035 0.0038 0.0041 0.0045 0.0047 0.0050 0.0054 0.0056 0.0059 0.0061 0.0064 0.0066 0.0057 0.0067 0.0070 0.0072 0.0074 0.0077 0.0078 0.0078 0.0080 0.0080 0.0083 0.0082 0.0084 0.0086 0.0087 0.0088 0.0089 0.0091 0.0092 0.0093 0.0094 0.0096 0.0097 0.0098 0.0099 0.0100 0.0101 0.0101 0.0103 0.0104 0.0104 0.0104 0.0105 0.0106 0.0107 0.0109 0.0109 0.0110 0.0112 0.0113 0.0117 0.0122 0.0128];
        scans        = 3:1:64;  % Modified by FR: 1:1:64 before
        axial_stress = ([20 45:5:130 60 130:5:150 152:2:184 185:1:200 200 200 200 200])*25/16;
        Pc           = [10 35*ones(1,57) 34 33 32 31]; %Modified FR: here Pc was changed during experiment
        Pp           = 5;
        
        data_old     = [scans' axial_stress' Pc' eps'];
        i_rem        = logical((scans==21)+(scans==22)); % remove scans 21 and 22 in Monz4
        data_new     = data_old(~i_rem, :);
        scans        = data_new(:,1)';
        axial_stress = data_new(:,2)';
        Pc = data_new(:,3)';
        eps          = data_new(:,4)';
        
        Poring       = 26.25;
        diff_stress  = axial_stress - (Pc-Pp) - Poring;
        fail_stress  = 200*25/16 - (30 -5) - Poring;
        yield_scan   = 47;
        fail_scan    = 64;
           
        Pc           = 35;   %Modified FR: here Pc is left constant to avoid error in the title of the plot
        
    elseif ei==6
        % WG01
        exp          = 'WG01'
        eps          = [0 0.0033 0.0045 0.0050 0.0053 0.0056 0.0059 0.0062 0.0063 0.0065 0.0066 0.0069 0.0071 0.0073 0.0073 0.0076 0.0076 0.0078 0.0080 0.0082 0.0086 0.0087 0.0090 0.0091 0.0094 0.0095 0.0097 0.0098 0.0100 0.0100 0.0102 0.0103 0.0105 0.0107 0.0110 0.0112];
        scans        = 4:1:39;  % Modified by FR: 3:1:40 before
        axial_stress = [12 15:5:140 142:2:154 158 160]*25/16;
        Pc           = 5;
        Pp           = 0;
        Poring       = 18.437;
        diff_stress  = axial_stress - (Pc - Pp) - Poring;
        fail_stress  = 162.057*25/16 - 5 - Poring;
        yield_scan   = 30;
        fail_scan    = 39;
    elseif ei==7
        % WG02
        exp          = 'WG02'
        eps          = [0 0.0010 0.0013 0.0017 0.0020 0.0023 0.0026 0.0027 0.0027 0.0027 0.0031 0.0035 0.0040 0.0043 0.0046 0.0049 0.0052 0.0056 0.0057 0.0059 0.0061 0.0064 0.0067 0.0071 0.0074 0.0088];
        scans        = [2:1:26 29];   % Modified by FR: 1:1:26 before
        axial_stress = [15:5:45 45 45:5:120 120 122]*25/16;
        axial_stress1= [15:5:45 45 45:5:120 120 122];
        Pc           = 5;
        Pp           = 0;
        Poring       = 18.437;
        diff_stress  = axial_stress - (Pc - Pp) - Poring;
        fail_stress  = 122.085*25/16 - 5 - Poring;
        yield_scan    = 24;
        fail_scan     = 29;
        
    end
    
    sig_dists = (fail_stress-diff_stress)/fail_stress;
    
%     if ei<=2 || ei == 5 || ei==8
%         times = axial_stress;
%     else
%         times = scans;
%     end
%     
%     times_real = [times' eps' diff_stress' sig_dists']; 
%     
%     mat_name = ['mats/times_' exp '.mat'];
%     save(mat_name, 'times_real');
%     disp(mat_name)    
%     
%     return
    
    figure(1)
    subplot(2,4, ei)
    hold on
    
    yyaxis left
    plot(eps, diff_stress, 'ko', 'MarkerSize', 10, 'linewidth', 2)
    ylim([min(diff_stress) max(diff_stress)])
    ylabel('differential stress (MPa)')
    
    yyaxis right
    ylim([min(sig_dists) max(sig_dists)])
    ylabel(['distance from failure' char(10) '(\sigma_f - \sigma)/\sigma_f'])
    
    ax = gca;
    ax.YAxis(1).Color = 'k';
    ax.YAxis(2).Color = 'r';
    ax.YAxis(2).Direction = 'reverse';
    
    xlim([0 max(eps)])
    xlabel('axial strain')
    box on
    set(gca, 'FontSize', 16)
    set(gca, 'linewidth', 2)
    title([exp ', ' num2str(length(diff_stress)) ' scans' char(10) '\sigma_2=' num2str(Pc) ' MPa \sigma_f= ' num2str(round(fail_stress, 1)) ' MPa'])
    
    ei=ei+1;
end

return
figure(1)
set(gcf, 'PaperPositionMode', 'auto')
print(fign, '-painters', '-depsc')
disp(fign)